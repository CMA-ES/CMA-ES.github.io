<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>cma.constraints_handler.ConstrainedFitnessAL</title>
    <meta name="generator" content="pydoctor 22.2.2"> 
        
    </meta>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width, initial-scale=0.75" name="viewport" />
    <link href="bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="apidocs.css" rel="stylesheet" type="text/css" />
    <link href="extra.css" rel="stylesheet" type="text/css" />
</head>

  <body>

    

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            cma <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="class"><code><code><a href="index.html" class="internal-link">cma</a></code><wbr></wbr>.<code><a href="cma.constraints_handler.html" class="internal-link" title="cma.constraints_handler">constraints_handler</a></code><wbr></wbr>.<code><a href="cma.constraints_handler.ConstrainedFitnessAL.html" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL">ConstrainedFitnessAL</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        class documentation
      </div>

      <div class="extrasDocstring">
        <p><code><span class="py-keyword">class</span> <span class="py-defname">ConstrainedFitnessAL</span>:</code></p>
        <p><a href="classIndex.html#cma.constraints_handler.ConstrainedFitnessAL">View In Hierarchy</a></p>
      </div>

      <div class="moduleDocstring">
        <div><p>Construct an unconstrained objective function from constraints.</p>
<p>This class constructs an unconstrained "fitness" function (to be
minimized) from an objective function and an inequality constraints
function (which returns a list of constraint values). An
equality constraint <tt class="rst-docutils literal">h(x) == 0</tt> must be expressed as two inequality
constraints like <tt class="rst-docutils literal">[h(x) - eps, <span class="pre">-h(x)</span> - eps]</tt> with <tt class="rst-docutils literal">eps &gt;= 0</tt>.
Non-positive values &lt;= 0 are considered feasible.</p>
<p>The <code><a href="#update" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.update">update</a></code> method of the class instance needs to be called after each
iteration. Depending on the setting of <code><a href="#which" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.which">which</a></code>, <code><a href="#update" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.update">update</a></code> may call
<tt class="rst-docutils literal">get_solution(es)</tt> which shall return the solution to be used for the
constraints handling update, by default <tt class="rst-docutils literal">_get_favorite_solution ==
lambda es: es.ask(1, <span class="pre">sigma_fac=0)[0]</span></tt>. The additional evaluation of
objective and constraints is avoided by the default <tt class="rst-docutils literal"><span class="pre">which='best'</span></tt>,
using the best solution in the current iteration.</p>
<p><code>find_feasible_first</code> optimizes to get a feasible solution first, which
only works if no equality constraints are implemented. For this reason
the default is <code>False</code>.</p>
<p>Minimal example (verbosity set for doctesting):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">import</span> cma
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">def</span> <span class="py-defname">constraints</span>(x):  <span class="py-comment"># define the constraint</span>
<span class="py-more">... </span>    <span class="py-keyword">return</span> [x[0] + 1, x[1]]  <span class="py-comment"># shall be &lt;= 0</span>
<span class="py-prompt">&gt;&gt;&gt; </span>cfun = cma.ConstrainedFitnessAL(cma.ff.sphere, constraints,
<span class="py-more">... </span>                                find_feasible_first=<span class="py-builtin">True</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>es = cma.CMAEvolutionStrategy(3 * [1.1], 0.1,
<span class="py-more">... </span>                  {<span class="py-string">'tolstagnation'</span>: 0, <span class="py-string">'verbose'</span>:-9})  <span class="py-comment"># verbosity for doctest only</span>
<span class="py-prompt">&gt;&gt;&gt; </span>es = es.optimize(cfun, callback=cfun.update)
<span class="py-prompt">&gt;&gt;&gt; </span>x = es.result.xfavorite</pre><p>The best <code>x</code> return value of <code><a href="cma.evolution_strategy.html#fmin2" class="internal-link" title="cma.evolution_strategy.fmin2">cma.fmin2</a></code> may not be useful, because
the underlying function changes over time. Therefore, we use
<code>es.result.xfavorite</code>, which is still not guarantied to be a feasible
solution. Alternatively, <code>cfun.best_feas.x</code> contains the best evaluated
feasible solution. However, this is not necessarily expected to be a
good solution, see below.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> <span class="py-builtin">sum</span>((x - [-1, 0, 0])**2) &lt; 1e-9, x
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> es.countevals &lt; 2200, es.countevals
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> cfun.best_feas.f &lt; 10, <span class="py-builtin">str</span>(cfun.best_feas)
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-comment"># print(es.countevals, cfun.best_feas.__dict__)</span></pre><p>To find a final feasible solution (close to <code>es.result.xfavorite</code>) we
can use the current <code><a href="cma.evolution_strategy.CMAEvolutionStrategy.html" class="internal-link" title="cma.evolution_strategy.CMAEvolutionStrategy">CMAEvolutionStrategy</a></code> instance <code>es</code>:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>x = cfun.find_feasible(es)  <span class="py-comment"># uses es.optimize to find (another) feasible solution</span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> constraints(x)[0] &lt;= 0, (x, cfun.best_feas.x)
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> cfun.best_feas.f &lt; 1 + 2e-6, <span class="py-builtin">str</span>(cfun.best_feas)
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> <span class="py-builtin">len</span>(cfun.archives) == 3
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">assert</span> cma.ConstrainedFitnessAL(cma.ff.sphere, constraints, archives=<span class="py-builtin">False</span>).archives == []</pre><p>Details: The fitness, to be minimized, is changing over time such that
the overall minimal value does not indicate the best solution.</p>
<p>The construction is based on the <code><a href="cma.constraints_handler.AugmentedLagrangian.html" class="internal-link" title="cma.constraints_handler.AugmentedLagrangian">AugmentedLagrangian</a></code> class. If, as by
default, <tt class="rst-docutils literal">self.finding_feasible is False</tt>, the fitness equals <tt class="rst-docutils literal">f(x)
+ sum_i (lam_i x g_i + mu_i x g_i / 2)</tt> where <tt class="rst-docutils literal">g_i = max(g_i(x),
<span class="pre">-lam_i</span> / mu_i)</tt> and lam_i and mu_i are generally positive and
dynamically adapted coefficients. Only lam_i can change the position of
the optimum in the feasible domain (and hence must converge to the
right value).</p>
<p>When <tt class="rst-docutils literal">self.finding_feasible is True</tt>, the fitness equals to <tt class="rst-docutils literal">sum_i
(g_i &gt; 0) x g_i^2</tt> and omits <tt class="rst-docutils literal">f + sum_i lam_i g_i</tt> altogether.
Whenever a feasible solution is found, the <code><a href="#finding_feasible" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.finding_feasible">finding_feasible</a></code> flag is
reset to <code>False</code>.</p>
<p><code>find_feasible(es)</code> sets <tt class="rst-docutils literal">finding_feasible = True</tt> and uses
<code>es.optimize</code> to optimize <code>self.__call__</code>. This works well with
<code><a href="cma.evolution_strategy.CMAEvolutionStrategy.html" class="internal-link" title="cma.evolution_strategy.CMAEvolutionStrategy">CMAEvolutionStrategy</a></code> but may easily fail with solvers that do not
consistently pass over the optimum in search space but approach the
optimum from one side only. This is not advisable if the feasible
domain has zero volume, e.g. when <code><a href="cma.constraints_handler.AugmentedLagrangian.html#g" class="internal-link" title="cma.constraints_handler.AugmentedLagrangian.g">g</a></code> models an equality like
<tt class="rst-docutils literal">g = lambda x: [h(x), <span class="pre">-h(x)]</span></tt>.</p>
<p>An equality constraint, h(x) = 0, cannot be handled like h**2 &lt;= 0,
because the Augmented Lagrangian requires the derivative at h == 0 to
be non-zero. Using abs(h) &lt;= 0 leads to divergence of coefficient mu
and the condition number. The best way is apparently using the two
inequality constraints [h &lt;= 0, -h &lt;= 0], which seems to work perfectly
well. The underlying <code><a href="cma.constraints_handler.AugmentedLagrangian.html" class="internal-link" title="cma.constraints_handler.AugmentedLagrangian">AugmentedLagrangian</a></code> class also accepts equality
constraints.</p>
</div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id397">
  
  
  <tr class="method">
    
    <td>Method</td>
    <td><code><a href="#__call__" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.__call__">__call__</a></code></td>
    <td>return AL fitness, append f and g values to <code>self.F</code> and <code>self.G</code>.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#__init__" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.__init__">__init__</a></code></td>
    <td>constructor with lazy initialization.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#find_feasible" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.find_feasible">find​_feasible</a></code></td>
    <td>find feasible solution by calling <tt class="rst-docutils literal">es.optimize(self)</tt>.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#initialize" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.initialize">initialize</a></code></td>
    <td>set search space dimension explicitely</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#log_in_es" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.log_in_es">log​_in​_es</a></code></td>
    <td>a hack to have something in the cma-logger divers plot.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#reset" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.reset">reset</a></code></td>
    <td>reset dynamic components</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#set_mu_lam" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.set_mu_lam">set​_mu​_lam</a></code></td>
    <td>set AL coefficients</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#update" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.update">update</a></code></td>
    <td>update AL coefficients, may be used as callback to <code><a href="cma.interfaces.OOOptimizer.html#optimize" class="internal-link" title="cma.interfaces.OOOptimizer.optimize">OOOptimizer.optimize</a></code>.</td>
  </tr><tr class="classvariable">
    
    <td>Class Variable</td>
    <td><code><a href="#archive_aggregators" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.archive_aggregators">archive​_aggregators</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#archives" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.archives">archives</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#best_aug" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.best_aug">best​_aug</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#best_f_plus_gpos" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.best_f_plus_gpos">best​_f​_plus​_gpos</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#best_feas" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.best_feas">best​_feas</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#constraints" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.constraints">constraints</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#count_calls" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.count_calls">count​_calls</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#count_updates" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.count_updates">count​_updates</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#dimension" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.dimension">dimension</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#F" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.F">F</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#F_plus_sum_al_G" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.F_plus_sum_al_G">​F_plus_sum_al_​G</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#find_feasible_aggregator" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.find_feasible_aggregator">find​_feasible​_aggregator</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#finding_feasible" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.finding_feasible">finding​_feasible</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#foffset" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.foffset">foffset</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#fun" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.fun">fun</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#G" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.G">G</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#get_solution" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.get_solution">get​_solution</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#logging" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.logging">logging</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#omit_f_calls_when_possible" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.omit_f_calls_when_possible">omit​_f​_calls​_when​_possible</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#which" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.which">which</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="property">
    
    <td>Property</td>
    <td><code><a href="#al" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.al">al</a></code></td>
    <td><code><a href="cma.constraints_handler.AugmentedLagrangian.html" class="internal-link" title="cma.constraints_handler.AugmentedLagrangian">AugmentedLagrangian</a></code> class instance</td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_fg_values" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._fg_values">​_fg​_values</a></code></td>
    <td>f, g values used to update the Augmented Lagrangian coefficients</td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_is_feasible" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._is_feasible">​_is​_feasible</a></code></td>
    <td>return True if last evaluated solution (or <code>gvals</code>) was feasible</td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_reset" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._reset">​_reset</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_reset_archives" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._reset_archives">​_reset​_archives</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_reset_arrays" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._reset_arrays">​_reset​_arrays</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_update_best" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._update_best">​_update​_best</a></code></td>
    <td>keep track of best solution and best feasible solution</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_al" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._al">​_al</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_set_coefficient_counts" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._set_coefficient_counts">​_set​_coefficient​_counts</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="property private">
    
    <td>Property</td>
    <td><code><a href="#_best_fg" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL._best_fg">​_best​_fg</a></code></td>
    <td>return current best f, g, where best is determined by the Augmented Lagrangian</td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.__call__">
    
  </a>
  <a name="__call__">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">__call__</span>(self, x):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>return AL fitness, append f and g values to <code>self.F</code> and <code>self.G</code>.</p>
<p>If <code>self.finding_feasible</code>, <code>fun(x)</code> is not called and <tt class="rst-docutils literal">f = np.nan</tt>.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.__init__">
    
  </a>
  <a name="__init__">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">__init__</span>(self, fun, constraints, dimension=None, which=<span class="rst-variable-quote">'</span><span class="rst-variable-string">best</span><span class="rst-variable-quote">'</span>, find_feasible_first=False, get_solution=<a href="cma.constraints_handler.html#_get_favorite_solution" class="internal-link" title="cma.constraints_handler._get_favorite_solution">_get_favorite_solution</a>, logging=None, archives=<a href="#archive_aggregators" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.archive_aggregators">archive_aggregators</a>):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>constructor with lazy initialization.</p>
<p>If <tt class="rst-docutils literal">which in ['mean', 'solution']</tt>, <code><a href="#get_solution" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.get_solution">get_solution</a></code> is called
(with the argument passed to the <code><a href="#update" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.update">update</a></code> method) to determine the
solution used to update the AL coefficients.</p>
<p>If <code>find_feasible_first</code>, only the constraints are optimized until
the first (fully) feasible solution is found.</p>
<p><code><a href="#logging" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.logging">logging</a></code> is the iteration gap for logging constraints related
data, in <code><a href="cma.constraints_handler.AugmentedLagrangian.html" class="internal-link" title="cma.constraints_handler.AugmentedLagrangian">AugmentedLagrangian</a></code>. 0 means no logging and negative
values have unspecified behavior.</p>
<p><code><a href="#archives" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.archives">archives</a></code> are the aggregator functions for constraints for
non-dominated biobjective archives. By default, the second
objective is <tt class="rst-docutils literal">max(g_+)</tt>, <tt class="rst-docutils literal">sum(g_+)</tt> or <tt class="rst-docutils literal"><span class="pre">sum(g_+^2)</span></tt>,
respectively. <tt class="rst-docutils literal">archives=True</tt> invokes the same behavior.
<tt class="rst-docutils literal">archives=False</tt> or an empty <code>tupel</code> prevents maintaining
archives.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.find_feasible">
    
  </a>
  <a name="find_feasible">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">find_feasible</span>(self, es, termination=(<wbr></wbr><span class="rst-variable-quote">'</span><span class="rst-variable-string">maxiter</span><span class="rst-variable-quote">'</span>, <wbr></wbr><span class="rst-variable-quote">'</span><span class="rst-variable-string">maxfevals</span><span class="rst-variable-quote">'</span>), aggregator=None):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>find feasible solution by calling <tt class="rst-docutils literal">es.optimize(self)</tt>.</p>
<p>Return best ever feasible solution <code>self.best_feas.x</code>.
See also <code>self.best_feas.info</code>.</p>
<p><code><a href="cma.constraints_handler.ConstrainedSolutionsArchive.html#aggregator" class="internal-link" title="cma.constraints_handler.ConstrainedSolutionsArchive.aggregator">aggregator</a></code>, defaulting to <code>self.find_feasible_aggregator</code>, is the
constraints aggregation function used as objective function to be
minimized. <code><a href="cma.constraints_handler.ConstrainedSolutionsArchive.html#aggregator" class="internal-link" title="cma.constraints_handler.ConstrainedSolutionsArchive.aggregator">aggregator</a></code> takes as input all constraint values and
returns a value &lt;= 0 if and only if the solution is feasible.</p>
<p>Terminate when either (another) feasible solution was found or any
of the <code>termination</code> keys is matched in <code>es.stop()</code>.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.initialize">
    
  </a>
  <a name="initialize">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">initialize</span>(self, dimension):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>set search space dimension explicitely</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.log_in_es">
    
  </a>
  <a name="log_in_es">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">log_in_es</span>(self, es, f, g):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>a hack to have something in the cma-logger divers plot.</p>
<p>Append the sum of positive g-values and the number of infeasible
constraints, displayed like 10**(number/10) (mapping [0, 10] to [1,
10]) if number &lt; 10, to <code>es.more_to_write</code>.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.reset">
    
  </a>
  <a name="reset">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">reset</span>(self):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>reset dynamic components</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.set_mu_lam">
    
  </a>
  <a name="set_mu_lam">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">set_mu_lam</span>(self, mu, lam):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>set AL coefficients</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.update">
    
  </a>
  <a name="update">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">update</span>(self, es):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>update AL coefficients, may be used as callback to <code><a href="cma.interfaces.OOOptimizer.html#optimize" class="internal-link" title="cma.interfaces.OOOptimizer.optimize">OOOptimizer.optimize</a></code>.</p>
<dl class="rst-docutils">
<dt>TODO: decide what happens when <code><a href="#__call__" class="internal-link" title="cma.constraints_handler.ConstrainedFitnessAL.__call__">__call__</a></code> was never called:</dt>
<dd>ignore (as for now) or update based on xfavorite by calling self(xfavorite),
assuming that update was called on purpose?
When method is not best, it should work without even call self(xfavorite).</dd>
</dl>
</div>
  </div>
</div><div class="baseclassvariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.archive_aggregators">
    
  </a>
  <a name="archive_aggregators">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">archive_aggregators</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.archives">
    
  </a>
  <a name="archives">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">archives</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.best_aug">
    
  </a>
  <a name="best_aug">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">best_aug</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.best_f_plus_gpos">
    
  </a>
  <a name="best_f_plus_gpos">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">best_f_plus_gpos</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.best_feas">
    
  </a>
  <a name="best_feas">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">best_feas</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.constraints">
    
  </a>
  <a name="constraints">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">constraints</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.count_calls">
    
  </a>
  <a name="count_calls">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">count_calls</span>: <code>int</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.count_updates">
    
  </a>
  <a name="count_updates">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">count_updates</span>: <code>int</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.dimension">
    
  </a>
  <a name="dimension">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">dimension</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.F">
    
  </a>
  <a name="F">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">F</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.F_plus_sum_al_G">
    
  </a>
  <a name="F_plus_sum_al_G">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">F_plus_sum_al_G</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.find_feasible_aggregator">
    
  </a>
  <a name="find_feasible_aggregator">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">find_feasible_aggregator</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.finding_feasible">
    
  </a>
  <a name="finding_feasible">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">finding_feasible</span>: <code>bool</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.foffset">
    
  </a>
  <a name="foffset">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">foffset</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.fun">
    
  </a>
  <a name="fun">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">fun</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.G">
    
  </a>
  <a name="G">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">G</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.get_solution">
    
  </a>
  <a name="get_solution">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">get_solution</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.logging">
    
  </a>
  <a name="logging">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">logging</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.omit_f_calls_when_possible">
    
  </a>
  <a name="omit_f_calls_when_possible">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">omit_f_calls_when_possible</span>: <code>bool</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.which">
    
  </a>
  <a name="which">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">which</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseproperty">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL.al">
    
  </a>
  <a name="al">
    
  </a>
  <div class="functionHeader">
    @property<br />
    <span class="py-defname">al</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><code><a href="cma.constraints_handler.AugmentedLagrangian.html" class="internal-link" title="cma.constraints_handler.AugmentedLagrangian">AugmentedLagrangian</a></code> class instance</div>
    
  </div>
</div><div class="basemethod private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._fg_values">
    
  </a>
  <a name="_fg_values">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_fg_values</span>(self, es):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>f, g values used to update the Augmented Lagrangian coefficients</div>
  </div>
</div><div class="basemethod private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._is_feasible">
    
  </a>
  <a name="_is_feasible">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_is_feasible</span>(self, gvals=None):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>return True if last evaluated solution (or <code>gvals</code>) was feasible</div>
  </div>
</div><div class="basemethod private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._reset">
    
  </a>
  <a name="_reset">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_reset</span>(self):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
  </div>
</div><div class="basemethod private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._reset_archives">
    
  </a>
  <a name="_reset_archives">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_reset_archives</span>(self):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
  </div>
</div><div class="basemethod private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._reset_arrays">
    
  </a>
  <a name="_reset_arrays">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_reset_arrays</span>(self):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
  </div>
</div><div class="basemethod private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._update_best">
    
  </a>
  <a name="_update_best">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_update_best</span>(self, x, f, g, g_al=None):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>keep track of best solution and best feasible solution</div>
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._al">
    
  </a>
  <a name="_al">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_al</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._set_coefficient_counts">
    
  </a>
  <a name="_set_coefficient_counts">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_set_coefficient_counts</span>: <code>list</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseproperty private">
  
  
  <a name="cma.constraints_handler.ConstrainedFitnessAL._best_fg">
    
  </a>
  <a name="_best_fg">
    
  </a>
  <div class="functionHeader">
    @property<br />
    <span class="py-defname">_best_fg</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div>return current best f, g, where best is determined by the Augmented Lagrangian</div>
    
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for cma,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.2 at 2022-03-19 17:09:59.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>